#! Generated by VisualDCT v2.6
#! DBDSTART
#! DBD("../../dbd/pmacUtil.dbd")
#! DBDEND

# This database provides detailed status for each axis in the PMAC, and is used
# in conjunction with pmacStatusAxis.[edl|opi]

# % macro, SYS,  	System name - Secondary subsystem should be CT
# % macro, DEV,		Device and axis number - Device should be MC:xxx
# % macro, AXIS,    Axis number
# % macro, PORT,    Asyn port


record(ai, "$(SYS)$(DEV)Pos-I") {
  field(DTYP, "stream")
  field(INP, "@pmac.proto getVar(#$(AXIS)P) $(PORT)")
}

record(ai, "$(SYS)$(DEV)Val:FollErr-I") {
  field(DTYP, "stream")
  field(INP, "@pmac.proto getVar(#$(AXIS)F) $(PORT)")
}

record(ai, "$(SYS)$(DEV)Val:Vlcty-I") {
  field(DTYP, "stream")
  field(INP, "@pmac.proto getVar(#$(AXIS)V) $(PORT)")
}

record(seq, "$(SYS)$(DEV)RB-Seq") {
  field(LNK1, "$(SYS)$(DEV)Pos-I.PROC PP")
  field(LNK2, "$(SYS)$(DEV)Val:FollErr-I.PROC PP")
  field(LNK3, "$(SYS)$(DEV)Val:Vlcty-I.PROC PP")
  field(LNK4, "$(SYS)$(DEV)Sts:Word-Sts.PROC PP")
  field(DLY1, "0")
  field(DLY2, "0.5")
  field(DLY3, "0.5")
  field(DLY4, "0.5")
  field(DOL1, "1")
  field(DOL2, "1")
  field(DOL3, "1")
  field(DOL4, "1")
}

record(stringin, "$(SYS)$(DEV)Sts:Word-Sts") {
  field(DTYP, "stream")
  field(INP,  "@pmac.proto getAxisStatus(#$(AXIS)?) $(PORT)")
}

record(scalcout, "$(SYS)$(DEV)Sts:1-Sts") {
  field(INAA, "$(SYS)$(DEV)Sts:Word-Sts CPP")
  field(CALC, "sscanf(AA,'%4x%8*x')")
}

record(scalcout, "$(SYS)$(DEV)Sts:2-Sts") {
  field(INAA, "$(SYS)$(DEV)Sts:Word-Sts CPP")
  field(CALC, "sscanf(AA,'%*4x%4x%4*x')")
}

record(scalcout, "$(SYS)$(DEV)Sts:3-Sts") {
  field(INAA, "$(SYS)$(DEV)Sts:Word-Sts CPP")
  field(CALC, "sscanf(AA,'%*8x%4x')")
}

